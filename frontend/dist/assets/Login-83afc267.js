import{_ as I,M as j,u as q,r as f,f as E,g as _,h as M,i as h,j as B,o as A,c as D,a as n,e as v,k as s,w as l,l as d,v as H,p as $,d as z,s as G}from"./index-1aea0b7d.js";const k=p=>($("data-v-b9835576"),p=p(),z(),p),J={class:"form-structor"},K={class:"signup"},O=k(()=>n("span",null,"or",-1)),Q={class:"form-holder"},W={class:"login slide-up"},X={class:"center"},Y=k(()=>n("span",null,"or",-1)),Z={class:"form-holder"},ee={__name:"Login",setup(p){const{socket:c}=j.getInstance(),L=q(),w=f(null),y=f(null),P=f(),V=f(),g=E(),N=_({username:[{required:!0,message:"Please enter your username",trigger:"blur"},{min:6,message:"The username contains a minimum of 6 characters"}],password:[{required:!0,message:"Please confirm the password",trigger:"blur"},{min:6,message:"The password contains a minimum of 6 characters"}]});var x=(t,e,r)=>{const i=/^1[3|4|5|7|8|9][0-9]{9}$/;if(!e)return r(new Error("Please confirm the phone number"));setTimeout(()=>{Number.isInteger(+e)?i.test(e)?r():r(new Error("The phone number format is incorrect")):r(new Error("Please enter a numeric value"))},100)};const R=_({username:[{required:!0,message:"Please enter your username",trigger:"blur"},{min:6,message:"The username contains a minimum of 6 characters"}],password:[{required:!0,message:"Please confirm the password",trigger:"blur"},{min:6,message:"The password contains a minimum of 6 characters"}],phone:[{validator:x,trigger:"blur"}]}),U=t=>{let e=t.target.parentNode.parentNode;Array.from(t.target.parentNode.parentNode.classList).find(r=>{r!=="slide-up"?e.classList.add("slide-up"):(y.value.parentNode.classList.add("slide-up"),e.classList.remove("slide-up"))})},C=t=>{let e=t.target.parentNode;Array.from(t.target.parentNode.classList).find(r=>{r!=="slide-up"?e.classList.add("slide-up"):(w.value.parentNode.parentNode.classList.add("slide-up"),e.classList.remove("slide-up"))})};M(()=>{g.joined(),c.on("joined_message",t=>{console.log(t),c.connect()})});const o=_({username:"",password:"",agreePolicy:!1,phone:""}),u=_({username:"",password:"",latitude:"",longitude:""}),F=()=>{V.value.validate(t=>{if(t)navigator.geolocation.getCurrentPosition(e=>{e!==void 0&&(console.log(e),u.latitude=e.coords.latitude,u.longitude=e.coords.longitude)},e=>{console.log(e)}),g.UserLogin(u).then(()=>{L.push({name:"Home"}),g.joined(),c.on("joined_message",e=>{console.log(e),c.connect()})});else return!1})},S=()=>{P.value.validate(t=>{if(t)o.agreePolicy?g.UserRegister(o).then(()=>{o.username="",o.password="",o.phone="",o.agreePolicy=!1}):G("Please agree to the privacy policy");else return!1})};return(t,e)=>{const r=h("el-input"),i=h("el-form-item"),T=h("el-link"),b=h("el-form"),m=B("autofocus");return A(),D("div",J,[n("div",K,[n("h2",{class:"form-title",ref_key:"signupRef",ref:y,onClick:C},[O,v("Sign up ")],512),n("div",Q,[s(b,{ref_key:"registerFormRef",ref:P,class:"form",model:o,rules:R},{default:l(()=>[s(i,{prop:"username"},{default:l(()=>[d(s(r,{modelValue:o.username,"onUpdate:modelValue":e[0]||(e[0]=a=>o.username=a),type:"text",placeholder:"Username"},null,8,["modelValue"]),[[m]])]),_:1}),s(i,{prop:"password"},{default:l(()=>[d(s(r,{modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=a=>o.password=a),type:"password",placeholder:"Password"},null,8,["modelValue"]),[[m]])]),_:1}),s(i,{prop:"phone"},{default:l(()=>[d(s(r,{modelValue:o.phone,"onUpdate:modelValue":e[2]||(e[2]=a=>o.phone=a),type:"text",placeholder:"Phone"},null,8,["modelValue"]),[[m]])]),_:1}),s(i,null,{default:l(()=>[d(n("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=a=>o.agreePolicy=a)},null,512),[[H,o.agreePolicy]]),s(T,{href:"https://www.baidu.com",target:"_blank",style:{"margin-left":"10px"}},{default:l(()=>[v("Privacy Policy")]),_:1})]),_:1}),s(i,null,{default:l(()=>[n("button",{class:"submit-btn",onClick:S},"Sign up")]),_:1})]),_:1},8,["model","rules"])])]),n("div",W,[n("div",X,[n("h2",{class:"form-title",ref_key:"loginRef",ref:w,onClick:U},[Y,v("Log in ")],512),n("div",Z,[s(b,{ref_key:"loginFormRef",ref:V,class:"form",model:u,rules:N},{default:l(()=>[s(i,{prop:"username"},{default:l(()=>[d(s(r,{modelValue:u.username,"onUpdate:modelValue":e[4]||(e[4]=a=>u.username=a),type:"text",placeholder:"UserName"},null,8,["modelValue"]),[[m]])]),_:1}),s(i,{prop:"username"},{default:l(()=>[d(s(r,{modelValue:u.password,"onUpdate:modelValue":e[5]||(e[5]=a=>u.password=a),type:"password",placeholder:"Password"},null,8,["modelValue"]),[[m]])]),_:1}),s(i,null,{default:l(()=>[n("button",{class:"submit-btn",onClick:F},"Log in")]),_:1})]),_:1},8,["model","rules"])])])])])}}},oe=I(ee,[["__scopeId","data-v-b9835576"]]);export{oe as default};
