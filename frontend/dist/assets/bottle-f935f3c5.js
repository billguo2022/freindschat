import{I as y,_ as D,f as U,u as E,r as C,h as W,n as H,s as J,i as d,o as i,q as r,w as o,k as s,a,e as c,c as F,F as K,y as O,x as u,C as g,B as w,t as P,p as Q,d as X,A as Y}from"./index-1aea0b7d.js";import{f as $}from"./friend-146d61d7.js";const v="/bottle",T={ThrowBottle:n=>y.post("".concat(v,"/throw"),n),PickBottle:n=>y.get("".concat(v,"/pick"),n),GiveBottle:n=>y.post("".concat(v,"/pick"),n),GetMyBottle:n=>y.get("".concat(v,"/my"),n),DeleteMyBottle:n=>y.delete("".concat(v,"/my"),n),GetTemporarilyBottle:n=>y.get("".concat(v,"/get_temporarily_bottle"),n)};const Z=n=>(Q("data-v-cb6d2299"),n=n(),X(),n),ee={class:"wrapper"},te={class:"btns"},oe={key:0},ne=Z(()=>a("h3",{style:{color:"#FFFFFF"}},"My box",-1)),le=["src"],se=["onClick"],ie={style:{"margin-top":"10px"}},ae={style:{display:"flex","align-items":"center","flex-direction":"column","justify-content":"center"}},re=["src"],ce=["onClick"],de={style:{"margin-top":"10px"}},ue={key:0,style:{display:"flex","align-items":"center","flex-direction":"column","justify-content":"center"}},_e={__name:"bottle",setup(n){const _=U(),B=E(),A=()=>B.back(),f=C({latitude:"",longitude:""});W(()=>{navigator.geolocation.getCurrentPosition(e=>{e!==void 0&&(console.log(e),f.latitude=e.coords.latitude,f.longitude=e.coords.longitude,f.longitude!==""&&f.latitude!==""?H.UpdateUserLocation({latitude:f.latitude,longitude:f.longitude}).then(l=>{l.code}):J("Get location failure"))},e=>{console.log(e)}),b()});const x=C({bottles:_.bottle().value.id?_.bottle().value:""}),S=C({user:""}),b=()=>{T.GetTemporarilyBottle().then(e=>{e.code===200&&(_.bottle().value=e.data.bottles,x.value.bottles=e.data.bottles)})},j=()=>{T.PickBottle({}).then(e=>{e.code===200&&(e.data||g("There are no bottles at the moment."),g(e.msg),S.value.user=e.data.user,_.bottle1().value=e.data.user,b())})},I=e=>{T.GiveBottle({id:e}).then(l=>{l.code===200?(g("Wait for consent"),_.bottle().value={},x.value=""):Y(l.msg)})},R=e=>{$.AgreeFriend({id:e}).then(l=>{l.code===200&&(g(l.msg),b())})},z=e=>{$.RefuseFriend({id:e}).then(l=>{l.code===200&&(g(l.msg),b())})},L=e=>{$.RefuseTemFriend({id:e}).then(l=>{l.code===200&&(g(l.msg),b())})};return(e,l)=>{const M=d("van-nav-bar"),N=d("el-header"),h=d("van-button"),p=d("el-col"),m=d("van-tag"),G=d("el-row"),V=d("el-main"),q=d("el-container");return i(),r(q,null,{default:o(()=>[s(N,null,{default:o(()=>[s(M,{title:"Current bottle","left-arrow":"",onClickLeft:A})]),_:1}),s(V,null,{default:o(()=>[a("div",ee,[a("div",te,[s(h,{type:"primary",onClick:l[0]||(l[0]=t=>j())},{default:o(()=>[c("Pick up one")]),_:1})])]),x.value.bottles.length>0?(i(),F("div",oe,[ne,(i(!0),F(K,null,O(x.value.bottles,t=>(i(),F("div",{style:{color:"#FFFFFF","border-radius":"20px",border:"#FFFFFF 1px solid",margin:"20px 0",padding:"20px"},key:t.id},[t.user.id===w(_).user().value.id?(i(),r(G,{key:0,gutter:15},{default:o(()=>[s(p,{span:4},{default:o(()=>[a("img",{src:t.friend.avatar,alt:"",style:{width:"50px",height:"50px"}},null,8,le)]),_:2},1024),s(p,{span:16},{default:o(()=>[a("div",{style:{display:"flex","flex-direction":"column","justify-content":"flex-start","margin-left":"20px"},onClick:k=>w(B).push("/index/".concat(t.friend.id))},[a("div",null," name: "+P(t.friend.username),1),a("span",ie,[t.friend.online===1?(i(),r(m,{key:0,type:"success"},{default:o(()=>[c("online")]),_:1})):u("",!0),t.friend.online===0?(i(),r(m,{key:1,type:"danger"},{default:o(()=>[c("offline")]),_:1})):u("",!0),t.friend.online===2?(i(),r(m,{key:2,type:"warning"},{default:o(()=>[c("busy")]),_:1})):u("",!0)])],8,se)]),_:2},1024),s(p,{span:4},{default:o(()=>[a("div",ae,[s(h,{size:"mini",onClick:k=>I(t.friend.id),icon:"plus",round:"",style:{"margin-bottom":"10px","margin-left":"0"}},null,8,["onClick"]),s(h,{size:"mini",onClick:k=>L(t.id),icon:"minus",style:{"margin-left":"0"},round:""},null,8,["onClick"])])]),_:2},1024)]),_:2},1024)):(i(),r(G,{key:1,gutter:15},{default:o(()=>[s(p,{span:4},{default:o(()=>[a("img",{src:t.user.avatar,alt:"",style:{width:"50px",height:"50px"}},null,8,re)]),_:2},1024),s(p,{span:16},{default:o(()=>[a("div",{style:{display:"flex","flex-direction":"column","justify-content":"flex-start","margin-left":"20px"},onClick:k=>w(B).push("/index/".concat(t.user.id))},[a("div",null," name: "+P(t.user.username),1),a("span",de,[t.user.online===1?(i(),r(m,{key:0,type:"success"},{default:o(()=>[c("online")]),_:1})):u("",!0),t.user.online===0?(i(),r(m,{key:1,type:"danger"},{default:o(()=>[c("offline")]),_:1})):u("",!0),t.user.online===2?(i(),r(m,{key:2,type:"warning"},{default:o(()=>[c("busy")]),_:1})):u("",!0)])],8,ce)]),_:2},1024),s(p,{span:4},{default:o(()=>[t.state?(i(),F("div",ue,[s(h,{size:"mini",onClick:k=>R(t.friend_table_id),round:"",style:{"margin-bottom":"10px","margin-left":"0"}},{default:o(()=>[c("agree ")]),_:2},1032,["onClick"]),s(h,{size:"mini",onClick:k=>z(t.friend_table_id),round:"",style:{"margin-left":"0"}},{default:o(()=>[c(" reject ")]),_:2},1032,["onClick"])])):u("",!0)]),_:2},1024)]),_:2},1024))]))),128))])):u("",!0)]),_:1})]),_:1})}}},me=D(_e,[["__scopeId","data-v-cb6d2299"]]);export{me as default};
