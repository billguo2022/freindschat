import{_ as G,f as L,r as g,i as o,j as P,o as T,q as F,w as t,k as a,a as i,t as h,B as c,e as d,l as I,A as R,z as q,C as b,n as E,G as J}from"./index-1aea0b7d.js";const M={class:"text"},$={class:"text"},H={style:{margin:"16px"}},K={style:{margin:"16px"}},Q={__name:"index",setup(W){const l=L(),s=g({online:parseInt(l.user().value.online),phone:l.user().value.phone}),_=g([{url:l.user().value.avatar}]),x=e=>{console.log("submit",e)},y=e=>{console.log("failed",e)},V=e=>{const n=e.type==="image/jpeg"?512e3:1024e3;return e.size>=n},k=e=>/(jpg|jpeg|png|JPG|PNG)/i.test(e.type)?!0:(R("Please upload images in the correct format"),!1),w=e=>{e.status="uploading",e.message="上传中...";let n=new FormData;n.append("file",e.file),q({url:"http://localhost:5000/file/avatar",method:"POST",data:n,headers:{"content-type":"multipart/form-data",Authorization:"bearer "+l.token().value}}).then(r=>{r.data.code===200&&(e.status="done",b(r.data.msg),_[0].url=r.data.data,l.user().value.avatar=r.data.data)})},S=()=>{E.UpdateUser({online:s.value.online,phone:s.value.phone}).then(e=>{e.code===200&&(b(e.msg),l.user().value=e.data.user)})};return(e,n)=>{const r=o("van-nav-bar"),z=o("el-header"),v=o("van-col"),D=o("van-row"),N=o("van-uploader"),p=o("van-field"),m=o("van-radio"),U=o("van-radio-group"),A=o("van-cell-group"),f=o("van-button"),C=o("van-form"),O=o("el-main"),j=o("el-container"),B=P("autofocus");return T(),F(j,null,{default:t(()=>[a(z,null,{default:t(()=>[a(r,{title:"My"})]),_:1}),a(O,null,{default:t(()=>[a(D,{style:{margin:"50px 0"}},{default:t(()=>[a(v,{span:"12",style:{"text-align":"center"}},{default:t(()=>[i("span",M,"Username："+h(c(l).user().value.username),1)]),_:1}),a(v,{span:"12",style:{"text-align":"center"}},{default:t(()=>[i("span",$,"Number："+h(c(l).user().value.number),1)]),_:1})]),_:1}),a(C,{onSubmit:x,onFailed:y},{default:t(()=>[a(A,{inset:""},{default:t(()=>[a(p,{name:"uploader",label:"Avatar"},{input:t(()=>[a(N,{modelValue:_.value,"onUpdate:modelValue":n[0]||(n[0]=u=>_.value=u),"max-size":V,"after-read":w,"before-read":k,reupload:"","max-count":"1"},null,8,["modelValue"])]),_:1}),a(p,{name:"switch",label:"Online state"},{input:t(()=>[a(U,{modelValue:s.value.online,"onUpdate:modelValue":n[1]||(n[1]=u=>s.value.online=u),direction:"horizontal"},{default:t(()=>[a(m,{name:0,"checked-color":"#1989fa"},{default:t(()=>[d("offline")]),_:1}),a(m,{name:1,"checked-color":"#1989fa"},{default:t(()=>[d("online")]),_:1}),a(m,{name:2,"checked-color":"#1989fa"},{default:t(()=>[d("busy")]),_:1})]),_:1},8,["modelValue"])]),_:1}),I(a(p,{modelValue:s.value.phone,"onUpdate:modelValue":n[2]||(n[2]=u=>s.value.phone=u),placeholder:"phone number"},null,8,["modelValue"]),[[B]])]),_:1}),i("div",H,[a(f,{round:"",block:"",type:"primary","native-type":"submit",onClick:S},{default:t(()=>[d(" Submit ")]),_:1})])]),_:1}),i("div",K,[a(f,{round:"",block:"",type:"danger","native-type":"submit",onClick:n[3]||(n[3]=u=>{c(l).LogOut(),c(J).push({name:"Login"})}),"loading-text":"LOADING ..."},{default:t(()=>[d(" Log out ")]),_:1})])]),_:1})]),_:1})}}},Y=G(Q,[["__scopeId","data-v-15045ee4"]]);export{Y as default};
